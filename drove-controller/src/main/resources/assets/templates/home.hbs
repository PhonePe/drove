{{#partial "content"}}
    <section>
        <div class="row">
            <div class="col">
                <table class="table table-bordered" id="clusterSummary">
                    <thead>
                    <tr>
                        <th class="text-center">Number of executors</th>
                        <th class="text-center">Number of Applications</th>
                        <th class="text-center">Number of Active Applications</th>
                        <th class="text-center">Free Cores</th>
                        <th class="text-center">Used Cores</th>
                        <th class="text-center">Total Cores</th>
                        <th class="text-center">Free Memory</th>
                        <th class="text-center">Used Memory</th>
                        <th class="text-center">Total Memory</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </section>
    <section>
        <div class="row">
            <div class="col-md-6 col-sm-12">
                <div class="row">
                    <div class="col"><h4>Applications</h4></div>
                </div>
                <div class="row">
                    <div class="col">
                        <table class="table table-bordered" id="applications" title="Applications">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Expected Instances</th>
                                <th>Healthy Instances</th>
                                <th>CPU</th>
                                <th>Memory (MB)</th>
                                <th>State</th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-sm-12">
                <div class="row">
                    <div class="col"><h4>Executors</h4></div>
                </div>
                <div class="row">
                    <div class="col">
                        <table class="table table-bordered"  id="executors">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Host</th>
                                <th>Free Cores</th>
                                <th>Used Cores</th>
                                <th>Free Memory</th>
                                <th>Used Memory</th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>
{{/partial}}

{{#partial "page_js"}}
    var cluster = $('#clusterSummary').DataTable({
        'processing' : true,
        'ajax': '/cluster/dt',
        'paging': false,
        'searching' : false,
        'ordering' : false,
        'info' : false,
        'columnDefs': [ {'className': 'text-center', 'targets': '_all'} ],
        'columns' : [
            { 'data' : 'numExecutors' },
            { 'data' : 'numApplications' },
            { 'data' : 'numActiveApplications' },
            { 'data' : 'freeCores' },
            { 'data' : 'usedCores' },
            { 'data' : 'totalCores' },
            { 'data' : 'freeMemory' },
            { 'data' : 'usedMemory' },
            { 'data' : 'totalMemory' }
        ]
    });
    var applications = $('#applications').DataTable({
        'processing' : true,
        'ajax': '/applications/dt',
        'paging': false,
        'info' : false,
        'columnDefs': [
            {
                'className': 'text-center',
                'targets': '_all'
            }
        ],
        'columns' : [
            {
                'data' : 'id' ,
                'render' : function(data, type, row, meta) {
                    return '<a href="/applications/' + data + '">' + data + '</a>';
                }
            },
            { 'data' : 'spec.name' },
            { 'data' : 'requiredInstances' },
            { 'data' : 'healthyInstances' },
            { 'data' : 'totalCPUs' },
            { 'data' : 'totalMemory' },
            { 'data' : 'state' }
        ]
    });
    var executors = $('#executors').DataTable({
        'processing' : true,
        'ajax': '/executors/dt',
        'paging': false,
        'info' : false,
        'columnDefs': [
            {
                'className': 'text-center',
                'targets': [2,3,4,5]
            }
        ],
        'columns' : [
            {
                'data' : 'executorId' ,
                'render' : function(data, type, row, meta) {
                    return '<a href="/executors/' + data + '">' + data + '</a>';
                }
            },
            { 'data' : 'hostname' },
            { 'data' : 'freeCores' },
            { 'data' : 'usedCores' },
            { 'data' : 'freeMemory' },
            { 'data' : 'usedMemory' }
        ]
    });

    setInterval(() => {
        cluster.ajax.reload();
        applications.ajax.reload();
        executors.ajax.reload();
    }, 5000);
{{/partial}}
{{> common/base}}